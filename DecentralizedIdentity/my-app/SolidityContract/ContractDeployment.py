from web3 import Web3
# Contract bytecode and ABI
contract_bytecode = "608060405234801561000f575f80fd5b50610a068061001d5f395ff3fe608060405234801561000f575f80fd5b5060043610610055575f3560e01c80630e52f48a146100595780630f9cc7b91461008957806346dd4bef146100a5578063b6d7bd37146100d5578063f8b7800f14610105575b5f80fd5b610073600480360381019061006e9190610524565b610135565b60405161008091906105e5565b60405180910390f35b6100a3600480360381019061009e9190610605565b6101e2565b005b6100bf60048036038101906100ba9190610524565b61023d565b6040516100cc9190610695565b60405180910390f35b6100ef60048036038101906100ea9190610524565b610272565b6040516100fc91906105e5565b60405180910390f35b61011f600480360381019061011a9190610524565b610324565b60405161012c91906105e5565b60405180910390f35b60605f8260405161014691906106e8565b9081526020016040518091039020805461015f9061072b565b80601f016020809104026020016040519081016040528092919081815260200182805461018b9061072b565b80156101d65780601f106101ad576101008083540402835291602001916101d6565b820191905f5260205f20905b8154815290600101906020018083116101b957829003601f168201915b50505050509050919050565b805f836040516101f291906106e8565b9081526020016040518091039020908161020c9190610901565b508160018260405161021e91906106e8565b908152602001604051809103902090816102389190610901565b505050565b5f8060018360405161024f91906106e8565b908152602001604051809103902080546102689061072b565b9050119050919050565b5f818051602081018201805184825260208301602085012081835280955050505050505f9150905080546102a59061072b565b80601f01602080910402602001604051908101604052809291908181526020018280546102d19061072b565b801561031c5780601f106102f35761010080835404028352916020019161031c565b820191905f5260205f20905b8154815290600101906020018083116102ff57829003601f168201915b505050505081565b6001818051602081018201805184825260208301602085012081835280955050505050505f9150905080546103589061072b565b80601f01602080910402602001604051908101604052809291908181526020018280546103849061072b565b80156103cf5780601f106103a6576101008083540402835291602001916103cf565b820191905f5260205f20905b8154815290600101906020018083116103b257829003601f168201915b505050505081565b5f604051905090565b5f80fd5b5f80fd5b5f80fd5b5f80fd5b5f601f19601f8301169050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b610436826103f0565b810181811067ffffffffffffffff8211171561045557610454610400565b5b80604052505050565b5f6104676103d7565b9050610473828261042d565b919050565b5f67ffffffffffffffff82111561049257610491610400565b5b61049b826103f0565b9050602081019050919050565b828183375f83830152505050565b5f6104c86104c384610478565b61045e565b9050828152602081018484840111156104e4576104e36103ec565b5b6104ef8482856104a8565b509392505050565b5f82601f83011261050b5761050a6103e8565b5b813561051b8482602086016104b6565b91505092915050565b5f60208284031215610539576105386103e0565b5b5f82013567ffffffffffffffff811115610556576105556103e4565b5b610562848285016104f7565b91505092915050565b5f81519050919050565b5f82825260208201905092915050565b5f5b838110156105a2578082015181840152602081019050610587565b5f8484015250505050565b5f6105b78261056b565b6105c18185610575565b93506105d1818560208601610585565b6105da816103f0565b840191505092915050565b5f6020820190508181035f8301526105fd81846105ad565b905092915050565b5f806040838503121561061b5761061a6103e0565b5b5f83013567ffffffffffffffff811115610638576106376103e4565b5b610644858286016104f7565b925050602083013567ffffffffffffffff811115610665576106646103e4565b5b610671858286016104f7565b9150509250929050565b5f8115159050919050565b61068f8161067b565b82525050565b5f6020820190506106a85f830184610686565b92915050565b5f81905092915050565b5f6106c28261056b565b6106cc81856106ae565b93506106dc818560208601610585565b80840191505092915050565b5f6106f382846106b8565b915081905092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061074257607f821691505b602082108103610755576107546106fe565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026107b77fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8261077c565b6107c1868361077c565b95508019841693508086168417925050509392505050565b5f819050919050565b5f819050919050565b5f6108056108006107fb846107d9565b6107e2565b6107d9565b9050919050565b5f819050919050565b61081e836107eb565b61083261082a8261080c565b848454610788565b825550505050565b5f90565b61084661083a565b610851818484610815565b505050565b5b81811015610874576108695f8261083e565b600181019050610857565b5050565b601f8211156108b95761088a8161075b565b6108938461076d565b810160208510156108a2578190505b6108b66108ae8561076d565b830182610856565b50505b505050565b5f82821c905092915050565b5f6108d95f19846008026108be565b1980831691505092915050565b5f6108f183836108ca565b9150826002028217905092915050565b61090a8261056b565b67ffffffffffffffff81111561092357610922610400565b5b61092d825461072b565b610938828285610878565b5f60209050601f831160018114610969575f8415610957578287015190505b61096185826108e6565b8655506109c8565b601f1984166109778661075b565b5f5b8281101561099e57848901518255600182019150602085019450602081019050610979565b868310156109bb57848901516109b7601f8916826108ca565b8355505b6001600288020188555050505b50505050505056fea2646970667358221220ccb723bbdc8d66119ff9d32114c84b667c9b3654ba840efbed7ce7039941e58c64736f6c63430008160033"
contract_abi = [
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"name": "CheckEmail",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "privateKey",
				"type": "string"
			}
		],
		"name": "FinalCheckEmailMapping",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "email",
				"type": "string"
			}
		],
		"name": "InitialCheckEmailMapping",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"name": "SaveEmail",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "privateKey",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "email",
				"type": "string"
			}
		],
		"name": "SaveEmailMapping",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	}
]

# Ethereum node endpoint (replace with your own endpoint)
ethereum_node_url = "https://goerli.infura.io/v3/b4e87e31b3df4aba9f33d76ec45a139d"

# Account private key (replace with your own private key)
private_key = "7fd14eed812ee800b2e7d536090d5d514a2341bea36b04efba90a8d9abaf94b1"

# Connect to the Ethereum node
w3 = Web3(Web3.HTTPProvider(ethereum_node_url))

account = "0x5780326e9F221afd01253C954b453ccCf4f2F30E"

# Build the contract
contract = w3.eth.contract(abi=contract_abi, bytecode=contract_bytecode)

# Estimate gas for the constructor
gas_estimate = contract.constructor().estimate_gas()

# Build the transaction
construct_txn = contract.constructor().build_transaction({
    'from': account,
    'gas':int(gas_estimate * 2),
    'gasPrice': w3.to_wei('40', 'gwei'),
    'nonce': w3.eth.get_transaction_count(account),
})

# Sign the transaction
signed_txn = w3.eth.account.sign_transaction(construct_txn, private_key)

# Send the transaction
transaction_hash = w3.eth.send_raw_transaction(signed_txn.rawTransaction)

# Wait for the transaction to be mined
transaction_receipt = w3.eth.wait_for_transaction_receipt(transaction_hash, )

# Get the deployed contract address
contract_address = transaction_receipt['contractAddress']

print("Contract deployed at address:", contract_address)
